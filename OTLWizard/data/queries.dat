select cla.name as name,cla.label_nl as friendlyname,cla.definition_nl as definition,cla.uri as uri, CASE WHEN cla.deprecated_version IS NOT NULL AND cla.deprecated_version != '' THEN 'TRUE' ELSE 'FALSE' END as deprecated from OSLOClass as cla left join OSLORelaties as rel on rel.uri = cla.uri where rel.uri is NULL AND (cla.uri like '%installatie%' or cla.uri like '%onderdeel%')
With tempTable as ( select osloAttributen.class_uri as Klasse, osloAttributen.name as HoofdAttribuut, osloAttributen.uri as HoofdAttribuut_URI, osloAttributen.type as HoofdAttribuut_DataType, osloAttributen.deprecated_version as HoofdAttribuut_Deprecated, osloAttributenType1.name as SubAttribuut, osloAttributenType1.uri as SubAttribuut_URI, osloAttributenType1.type as SubAttribuut_DataType, osloAttributenType1.deprecated_version as SubAttribuut_Deprecated, osloAttributenType2.name as SubAttribuutTwee, osloAttributenType2.uri as SubAttribuutTwee_URI, osloAttributenType2.type as SubAttribuutTwee_DataType, osloAttributenType2.deprecated_version as SubAttribuutTwee_Deprecated, osloAttributenType3.name as UnionAttribuut, osloAttributenType3.uri as UnionAttribuut_URI, osloAttributenType3.type as UnionAttribuut_DataType, osloAttributenType3.deprecated_version as UnionAttribuut_Deprecated, osloAttributenType4.name as UnionSubAttribuut, osloAttributenType4.uri as UnionSubAttribuut_URI, osloAttributenType4.type as UnionSubAttribuut_DataType, osloAttributenType4.deprecated_version as UnionSubAttribuut_Deprecated, osloAttributenPrimitive.type as PrimitiveAttribuut_DataType, osloAttributenPrimitiveUnits.usagenote_nl as PrimitiveAttribuut_Unit, CASE WHEN osloAttributen.deprecated_version IS NOT NULL AND osloAttributen.deprecated_version != '' OR osloAttributenType1.deprecated_version IS NOT NULL AND osloAttributenType1.deprecated_version != '' OR osloAttributenType2.deprecated_version IS NOT NULL AND osloAttributenType2.deprecated_version != '' OR osloAttributenType3.deprecated_version IS NOT NULL AND osloAttributenType3.deprecated_version != '' OR osloAttributenType4.deprecated_version IS NOT NULL AND osloAttributenType4.deprecated_version != '' THEN 'TRUE' ELSE 'FALSE' END AS deprecation, CASE WHEN osloAttributen.kardinaliteit_max LIKE '1' THEN '' ELSE '[]' END AS positie1, CASE WHEN osloAttributenType1.kardinaliteit_max LIKE '1' THEN '' ELSE '[]' END AS positie2, CASE WHEN osloAttributenType2.kardinaliteit_max LIKE '1' THEN '' ELSE '[]' END AS positie3, CASE WHEN osloAttributenType3.kardinaliteit_max LIKE '1' THEN '' ELSE '[]' END AS positie4, CASE WHEN osloAttributenType4.kardinaliteit_max LIKE '1' THEN '' ELSE '[]' END AS positie5, enumlisting.codelist as codelijst, osloAttributen.definition_nl AS definitie, osloAttributenType1.definition_nl AS definitie1, osloAttributenType2.definition_nl AS definitie2, osloAttributenType3.definition_nl AS definitie3, osloAttributenType4.definition_nl AS definitie4 from osloAttributen as osloAttributen left outer join osloDatatypeComplexAttributen as osloAttributenType1 on osloAttributen.type = osloAttributenType1.class_uri left outer join osloDatatypeComplexAttributen as osloAttributenType2 on osloAttributenType1.type = osloAttributenType2.class_uri left outer join osloDatatypeUnionAttributen as osloAttributenType3 on osloAttributen.type = osloAttributenType3.class_uri left outer join osloDatatypeComplexAttributen as osloAttributenType4 on osloAttributenType3.type = osloAttributenType4.class_uri left outer join osloEnumeration as enumlisting on ( enumlisting.uri = osloAttributen.type OR enumlisting.uri = osloAttributenType1.type OR enumlisting.uri = osloAttributenType2.type OR enumlisting.uri = osloAttributenType3.type OR enumlisting.uri = osloAttributenType4.type ) left outer join osloDatatypePrimitiveAttributen as osloAttributenPrimitive on ( osloAttributenPrimitive.uri = osloAttributen.type || '.waarde' OR osloAttributenPrimitive.uri = osloAttributenType1.type || '.waarde' OR osloAttributenPrimitive.uri = osloAttributenType2.type || '.waarde' OR osloAttributenPrimitive.uri = osloAttributenType3.type || '.waarde' OR osloAttributenPrimitive.uri = osloAttributenType4.type || '.waarde' ) left outer join osloDatatypePrimitiveAttributen as osloAttributenPrimitiveUnits on ( osloAttributenPrimitiveUnits.uri = osloAttributen.type || '.standaardEenheid' OR osloAttributenPrimitiveUnits.uri = osloAttributenType1.type || '.standaardEenheid' OR osloAttributenPrimitiveUnits.uri = osloAttributenType2.type || '.standaardEenheid' OR osloAttributenPrimitiveUnits.uri = osloAttributenType3.type || '.standaardEenheid' OR osloAttributenPrimitiveUnits.uri = osloAttributenType4.type || '.standaardEenheid' ) where osloAttributen.class_uri like '%[OSLOCLASS]%' ) select substr( ( COALESCE('.' || HoofdAttribuut || positie1, '') || COALESCE('.' || SubAttribuut || positie2, '') || COALESCE('.' || SubAttribuutTwee || positie3, '') || COALESCE('.' || UnionAttribuut || positie4, '') || COALESCE('.' || UnionSubAttribuut || positie5, '') ), 2 ) as dotnotatie, COALESCE(definitie4, definitie3, definitie2, definitie1, definitie) as description, COALESCE(UnionSubAttribuut_DataType,UnionAttribuut_DataType,SubAttribuutTwee_DataType,SubAttribuut_DataType,HoofdAttribuut_DataType) as dataType, COALESCE(UnionSubAttribuut,UnionAttribuut,SubAttribuutTwee,SubAttribuut,HoofdAttribuut) as friendlyName, deprecation FROM tempTable;
select doel_uri,bron_uri,uri,richting from OSLORelaties
With meetTabel as ( select uri as type, voorwaarde as meetcriterium, overervingsgrens, CASE WHEN meten LIKE '1' THEN 'meten' ELSE NULL END AS me1, CASE WHEN overerven LIKE '1' THEN 'overerven' ELSE NULL END AS me2 from MetenOfOvererven ), steekkaartTabel as ( select uri as stkuri, steekkaart from LegendeboekSteekkaarten ), specialeTabel as ( select uri as specuri, CQL_notatie, if_true, if_false, tekstnotatie from GeometrieCriteria ), overervingsTabel as ( select bron_uri, doel_uri, relatie_uri, richting, replace(relatie_uri,'https://wegenenverkeer.data.vlaanderen.be/ns/onderdeel#','') as relatie, replace(doel_uri,'https://wegenenverkeer.data.vlaanderen.be/ns/onderdeel#','') as overervenvan from GeometrieOvererven ), geoTabel as ( select geom.uri as URL, geom.label_nl as objectnaam, CASE WHEN geom.geen_geometrie LIKE '1' THEN 'geen geometrie' ELSE NULL END AS geo1, CASE WHEN geom.punt3D LIKE '1' THEN 'punt 3D' ELSE NULL END AS geo2, CASE WHEN geom.lijn3D LIKE '1' THEN 'lijn 3D' ELSE NULL END AS geo3, CASE WHEN geom.polygoon3D LIKE '1' THEN 'polygoon 3D' ELSE NULL END AS geo4, meet.me1, meet.me2, meet.overervingsgrens as overervingsgrens, meet.meetcriterium as meetcriterium, group_concat(steek.steekkaart) as steekkaart, speciaal.tekstnotatie as uitzonderingen from GeometrieType as geom left outer join meetTabel as meet on meet.type = geom.uri left outer join steekkaartTabel as steek on geom.uri = steek.stkuri left outer join specialeTabel as speciaal on geom.uri = speciaal.specuri where uri like '%[OSLOCLASS]%' ), eindTabel as ( SELECT URL, objectnaam, trim(coalesce(geo1 || ',','') || coalesce(geo2 || ',','') || coalesce(geo3 || ',','') || coalesce(geo4 || ',','')) as geometrie, coalesce(me1,me2) as overerving, meetcriterium, uitzonderingen, overervingsgrens, steekkaart, overerf.relatie as viarelatie, overerf.overervenvan as overervenvan from geoTabel left outer join overervingsTabel as overerf on URL = overerf.bron_uri ) select coalesce(objectnaam,''), coalesce(geometrie,''), coalesce(overerving,''), coalesce(meetcriterium,''), coalesce(uitzonderingen,''), coalesce(overervingsgrens,''), coalesce(steekkaart,''), coalesce(overervenvan,''), coalesce(viarelatie,''),URL from eindTabel
